<#
.SYNOPSIS
    WSUS Scanner for CVE-2025-59287

.DESCRIPTION
    Checks WSUS servers for potential CVE-2025-59287 exposure

.PARAMETER ScanAllServers
    Scan all WSUS servers in Active Directory

.PARAMETER VerboseOutput  
    Enable detailed logging

.PARAMETER OutputPath
    Export results to CSV file

.EXAMPLE
    .\CVE-2025-59287.ps1 -ScanAllServers -VerboseOutput -OutputPath "C:\Temp\WSUS-Scan.csv"

.AUTHOR
    handcaster

.NOTES
    Requires ActiveDirectory module
#>
#Requires -Module ActiveDirectory


Write-Host "Quick CVE-2025-59287 WSUS Scanner" -ForegroundColor Green

$potentialWSUS = Get-ADComputer -Filter "((Name -like '*WSUS*') -or (Name -like '*UPDATE*') -or (Description -like '*WSUS*') -or (Description -like '*Update Services*')) -and (Enabled -eq 'True')" | Select-Object Name, DNSHostName, Description

if ($potentialWSUS.Count -eq 0) {
    Write-Host "No obvious WSUS servers found in AD." -ForegroundColor Yellow
    Write-Host "Checking all Windows servers..." -ForegroundColor Yellow
    
    $potentialWSUS = Get-ADComputer -Filter "OperatingSystem -like '*Server*' -and Enabled -eq 'True'" | Select-Object Name, DNSHostName, Description | Sort-Object Name
}

Write-Host "`nFound $($potentialWSUS.Count) potential WSUS servers:" -ForegroundColor Green
$potentialWSUS | Format-Table -AutoSize

Write-Host "These systems should be checked for WSUS installation and patched accordingly." -ForegroundColor Yellow
Write-Host "Reference: https://msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2025-59287" -ForegroundColor Cyan